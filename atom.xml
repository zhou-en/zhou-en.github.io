<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>En&#39;s Blog</title>
  
  <subtitle>Techy blogs</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://zhou-en.github.io/"/>
  <updated>2021-01-26T21:21:55.562Z</updated>
  <id>http://zhou-en.github.io/</id>
  
  <author>
    <name>En Zhou</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Some Notes on Poetry</title>
    <link href="http://zhou-en.github.io/2020/10/25/Some-Notes-on-Poetry/"/>
    <id>http://zhou-en.github.io/2020/10/25/Some-Notes-on-Poetry/</id>
    <published>2020-10-25T20:56:41.000Z</published>
    <updated>2021-01-26T21:21:55.562Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Install-poetry-on-Ubuntu-20-04"><a href="#Install-poetry-on-Ubuntu-20-04" class="headerlink" title="Install poetry on Ubuntu 20.04"></a>Install <code>poetry</code> on Ubuntu 20.04</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py | python -</span><br></pre></td></tr></tbody></table></figure><p>REF: <a href="https://python-poetry.org/docs/#installation">https://python-poetry.org/docs/#installation</a></p><a id="more"></a><h2 id="Error-when-starting-poetry-shell"><a href="#Error-when-starting-poetry-shell" class="headerlink" title="Error when starting poetry shell"></a>Error when starting <code>poetry shell</code></h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ModuleNotFoundError: No module named <span class="string">'virtualenv.seed.via_app_data'</span></span><br></pre></td></tr></tbody></table></figure><p>This is due to the <code>virtualenv</code> installed in the system, it can be solved by removing it:</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt remove python3-virtualenv</span><br></pre></td></tr></tbody></table></figure><h2 id="Add-packages-from-existing-requirements-txt"><a href="#Add-packages-from-existing-requirements-txt" class="headerlink" title="Add packages from existing requirements.txt"></a>Add packages from existing <code>requirements.txt</code></h2><p>Sometimes you already have a project and <code>reqirements.txt</code> setup, but you wantted to start using <code>poetry</code> to manage your dependencies. Here are the steps to add the existing dependencies from <code>requirements.txt</code> to <code>pyproject.toml</code> that generate by <code>poetry</code>.</p><ul><li>Start by generate a <code>pyproject.toml</code> file for <code>poetry</code>:<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poetry init</span><br></pre></td></tr></tbody></table></figure></li><li>In the directory where both <code>requirement.txt</code> and <code>pyproject.toml</code> are stored, run this command:<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat requirements.txt | perl -pe <span class="string">'s/([&lt;=&gt;]+)/:$1/'</span> | xargs -t -n 1 -I {} poetry add <span class="string">'{}'</span></span><br></pre></td></tr></tbody></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Install-poetry-on-Ubuntu-20-04&quot;&gt;&lt;a href=&quot;#Install-poetry-on-Ubuntu-20-04&quot; class=&quot;headerlink&quot; title=&quot;Install poetry on Ubuntu 20.04&quot;&gt;&lt;/a&gt;Install &lt;code&gt;poetry&lt;/code&gt; on Ubuntu 20.04&lt;/h2&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py | python -&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;REF: &lt;a href=&quot;https://python-poetry.org/docs/#installation&quot;&gt;https://python-poetry.org/docs/#installation&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="python" scheme="http://zhou-en.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>Encrypt and Decrypt File with `python-gnupg`</title>
    <link href="http://zhou-en.github.io/2020/10/21/Encrypt-and-Decrypt-File-with-python-gnupg/"/>
    <id>http://zhou-en.github.io/2020/10/21/Encrypt-and-Decrypt-File-with-python-gnupg/</id>
    <published>2020-10-20T22:23:54.000Z</published>
    <updated>2021-01-26T21:21:55.561Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Installation-Deployment"><a href="#Installation-Deployment" class="headerlink" title="Installation/Deployment"></a>Installation/Deployment</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install gnupg</span><br><span class="line">$ sudo adduser testgpguser</span><br><span class="line">$ sudo su testgpguser</span><br><span class="line">$ <span class="built_in">cd</span></span><br><span class="line">$ virtualenv --no-site-packages venv</span><br><span class="line">$ <span class="built_in">source</span> venv/bin/activate</span><br><span class="line">$ pip install python-gnupg</span><br></pre></td></tr></tbody></table></figure><a id="more"></a><h2 id="Importing-and-receiving-keys"><a href="#Importing-and-receiving-keys" class="headerlink" title="Importing and receiving keys"></a>Importing and receiving keys</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gnupg</span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line">gpg = gnupg.GPG(gnupghome=<span class="string">'/home/testgpguser/gpghome'</span>)</span><br><span class="line">key_data = open(<span class="string">'mykeyfile.asc'</span>).read()</span><br><span class="line">import_result = gpg.import_keys(key_data)</span><br><span class="line">pprint(import_result.results)</span><br></pre></td></tr></tbody></table></figure><h2 id="List-Keys"><a href="#List-Keys" class="headerlink" title="List Keys"></a>List Keys</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gnupg</span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line">gpg = gnupg.GPG(gnupghome=<span class="string">'/home/testgpguser/gpghome'</span>)</span><br><span class="line">public_keys = gpg.list_keys()</span><br><span class="line">private_keys = gpg.list_keys(<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'public keys:'</span></span><br><span class="line">pprint(public_keys)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'private keys:'</span></span><br><span class="line">pprint(private_keys)</span><br></pre></td></tr></tbody></table></figure><h2 id="Encrypt-File"><a href="#Encrypt-File" class="headerlink" title="Encrypt File"></a>Encrypt File</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gnupg</span><br><span class="line"></span><br><span class="line">gpg = gnupg.GPG(gnupghome=<span class="string">'/home/testgpguser/gpghome'</span>)</span><br><span class="line">open(<span class="string">'my-unencrypted.txt'</span>, <span class="string">'w'</span>).write(<span class="string">'You need to Google Venn diagram.'</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'my-unencrypted.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    status = gpg.encrypt_file(</span><br><span class="line">        f, recipients=[<span class="string">'testgpguser@mydomain.com'</span>],</span><br><span class="line">        output=<span class="string">'my-encrypted.txt.gpg'</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'ok: '</span>, status.ok</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'status: '</span>, status.status</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'stderr: '</span>, status.stderr</span><br></pre></td></tr></tbody></table></figure><h2 id="Decrypt-File"><a href="#Decrypt-File" class="headerlink" title="Decrypt File"></a>Decrypt File</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gnupg</span><br><span class="line"></span><br><span class="line">gpg = gnupg.GPG(gnupghome=<span class="string">'/home/testgpguser/gpghome'</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'my-encrypted.txt.gpg'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    status = gpg.decrypt_file(f, passphrase=<span class="string">'mypassphrase'</span>, output=<span class="string">'my-decrypted.txt'</span>)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'ok: '</span>, status.ok</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'status: '</span>, status.status</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'stderr: '</span>, status.stderr</span><br></pre></td></tr></tbody></table></figure><h2 id="Encrypt-String"><a href="#Encrypt-String" class="headerlink" title="Encrypt String"></a>Encrypt String</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gnupg</span><br><span class="line"></span><br><span class="line">gpg = gnupg.GPG(gnupghome=<span class="string">'/home/testgpguser/gpghome'</span>)</span><br><span class="line">unencrypted_string = <span class="string">'Who are you? How did you get in my house?'</span></span><br><span class="line">encrypted_data = gpg.encrypt(unencrypted_string, <span class="string">'testgpguser@mydomain.com'</span>)</span><br><span class="line">encrypted_string = str(encrypted_data)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'ok: '</span>, encrypted_data.ok</span><br><span class="line"><span class="keyword">print</span> <span class="string">'status: '</span>, encrypted_data.status</span><br><span class="line"><span class="keyword">print</span> <span class="string">'stderr: '</span>, encrypted_data.stderr</span><br><span class="line"><span class="keyword">print</span> <span class="string">'unencrypted_string: '</span>, unencrypted_string</span><br><span class="line"><span class="keyword">print</span> <span class="string">'encrypted_string: '</span>, encrypted_string</span><br></pre></td></tr></tbody></table></figure><h2 id="Decrypt-String"><a href="#Decrypt-String" class="headerlink" title="Decrypt String"></a>Decrypt String</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gnupg</span><br><span class="line"></span><br><span class="line">gpg = gnupg.GPG(gnupghome=<span class="string">'/home/testgpguser/gpghome'</span>)</span><br><span class="line">unencrypted_string = <span class="string">'Who are you? How did you get in my house?'</span></span><br><span class="line">encrypted_data = gpg.encrypt(unencrypted_string, <span class="string">'testgpguser@mydomain.com'</span>)</span><br><span class="line">encrypted_string = str(encrypted_data)</span><br><span class="line">decrypted_data = gpg.decrypt(encrypted_string, passphrase=<span class="string">'my passphrase'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'ok: '</span>, decrypted_data.ok</span><br><span class="line"><span class="keyword">print</span> <span class="string">'status: '</span>, decrypted_data.status</span><br><span class="line"><span class="keyword">print</span> <span class="string">'stderr: '</span>, decrypted_data.stderr</span><br><span class="line"><span class="keyword">print</span> <span class="string">'decrypted string: '</span>, decrypted_data.data</span><br></pre></td></tr></tbody></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a href="https://pythonhosted.org/python-gnupg/">python-gnupg - A Python wrapper for GnuPG — Python Wrapper for GnuPG 0.4.0 documentation</a><br><a href="https://www.saltycrane.com/blog/2011/10/python-gnupg-gpg-example/">Python gnupg (GPG) example - SaltyCrane Blog</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Installation-Deployment&quot;&gt;&lt;a href=&quot;#Installation-Deployment&quot; class=&quot;headerlink&quot; title=&quot;Installation/Deployment&quot;&gt;&lt;/a&gt;Installation/Deployment&lt;/h2&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo apt-get install gnupg&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ sudo adduser testgpguser&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ sudo su testgpguser&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ virtualenv --no-site-packages venv&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; venv/bin/activate&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ pip install python-gnupg&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Deploy Django Using Gunicorn and Nginx</title>
    <link href="http://zhou-en.github.io/2020/10/19/2020-10-19-deploy-django-using-gunicorn-and-nginx/"/>
    <id>http://zhou-en.github.io/2020/10/19/2020-10-19-deploy-django-using-gunicorn-and-nginx/</id>
    <published>2020-10-19T00:06:15.000Z</published>
    <updated>2021-01-26T21:21:55.561Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Install-Packages-from-the-Ubuntu-Repositories-for-Python-3"><a href="#Install-Packages-from-the-Ubuntu-Repositories-for-Python-3" class="headerlink" title="Install Packages from the Ubuntu Repositories for Python 3"></a>Install Packages from the Ubuntu Repositories for Python 3</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python3-pip python3-dev libpq-dev postgresql postgresql-contrib nginx</span><br></pre></td></tr></tbody></table></figure><a id="more"></a><h2 id="Create-the-PostgreSQL-Database-and-User"><a href="#Create-the-PostgreSQL-Database-and-User" class="headerlink" title="Create the PostgreSQL Database and User"></a>Create the PostgreSQL Database and User</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u postgres psql</span><br></pre></td></tr></tbody></table></figure><p>We are setting the default encoding to UTF-8, which Django expects. We are also setting the default transaction isolation scheme to “read committed”, which blocks reads from uncommitted transactions. Lastly, we are setting the timezone. By default, our Django projects will be set to use UTC. These are all recommendations from the <a href="https://docs.djangoproject.com/en/1.9/ref/databases/#optimizing-postgresql-s-configuration">Django project itself</a>:</p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> myprojectuser <span class="keyword">WITH</span> <span class="keyword">PASSWORD</span> <span class="string">'password'</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">ROLE</span> myprojectuser <span class="keyword">SET</span> client_encoding <span class="keyword">TO</span> <span class="string">'utf8'</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">ROLE</span> myprojectuser <span class="keyword">SET</span> default_transaction_isolation <span class="keyword">TO</span> <span class="string">'read committed'</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">ROLE</span> myprojectuser <span class="keyword">SET</span> timezone <span class="keyword">TO</span> <span class="string">'UTC'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> <span class="keyword">DATABASE</span> myproject <span class="keyword">TO</span> myprojectuser;</span><br></pre></td></tr></tbody></table></figure><h2 id="Create-a-Python-3-Virtual-Environment-for-your-Project"><a href="#Create-a-Python-3-Virtual-Environment-for-your-Project" class="headerlink" title="Create a Python 3 Virtual Environment for your Project"></a>Create a Python 3 Virtual Environment for your Project</h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo -H pip3 install --upgrade pip</span><br><span class="line">sudo -H pip3 install virtualenv</span><br><span class="line">mkdir ~/myproject</span><br><span class="line"><span class="built_in">cd</span> ~/myproject</span><br><span class="line">virtualenv myprojectenv</span><br><span class="line"><span class="built_in">source</span> myprojectenv/bin/activate</span><br></pre></td></tr></tbody></table></figure><p>With your virtual environment active, install Django, Gunicorn, and the psycopg2 PostgreSQL adaptor with the local instance of pip:</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django gunicorn psycopg2</span><br></pre></td></tr></tbody></table></figure><h2 id="Create-and-Configure-a-New-Django-Project"><a href="#Create-and-Configure-a-New-Django-Project" class="headerlink" title="Create and Configure a New Django Project"></a>Create and Configure a New Django Project</h2><p>See: <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-django-with-postgres-nginx-and-gunicorn-on-ubuntu-16-04/#create-and-configure-new-django-project">How To Set Up Django with Postgres, Nginx, and Gunicorn on Ubuntu 16.04 | DigitalOcean</a></p><h2 id="Create-a-Gunicorn-systemd-Service-File-gunicorn-service-in-etc-systemd-system"><a href="#Create-a-Gunicorn-systemd-Service-File-gunicorn-service-in-etc-systemd-system" class="headerlink" title="Create a Gunicorn systemd Service File gunicorn.service in /etc/systemd/system/"></a>Create a Gunicorn systemd Service File <code>gunicorn.service</code> in <code>/etc/systemd/system/</code></h2><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=gunicorn daemon</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=sammy</span><br><span class="line">Group=www-data</span><br><span class="line">WorkingDirectory=/home/sammy/myproject</span><br><span class="line">ExecStart=/home/sammy/myproject/myprojectenv/bin/gunicorn --access-logfile - --workers 3 --<span class="built_in">bind</span> unix:/home/sammy/myproject/myproject.sock myproject.wsgi:application</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></tbody></table></figure><p>Start and enable gunicorn on system startup</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start gunicorn</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> gunicorn</span><br></pre></td></tr></tbody></table></figure><h3 id="Check-for-the-Gunicorn-Socket-File"><a href="#Check-for-the-Gunicorn-Socket-File" class="headerlink" title="Check for the Gunicorn Socket File"></a>Check for the Gunicorn Socket File</h3><ul><li><p>Check gunicorn status</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status gunicorn</span><br></pre></td></tr></tbody></table></figure></li><li><p>Next, check for the existence of the myproject.sock file within your project directory:</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls /home/sammy/myproject</span><br><span class="line">manage.py  myproject  myprojectenv  myproject.sock  static</span><br></pre></td></tr></tbody></table></figure></li><li><p>View gunicorn logs</p></li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo journalctl -u gunicorn</span><br></pre></td></tr></tbody></table></figure><ul><li>If you make changes to the /etc/systemd/system/gunicorn.service file, reload the daemon to reread the service definition and restart the Gunicorn process by typing:</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart gunicorn</span><br></pre></td></tr></tbody></table></figure><h2 id="Configure-Nginx-to-Proxy-Pass-to-Gunicorn"><a href="#Configure-Nginx-to-Proxy-Pass-to-Gunicorn" class="headerlink" title="Configure Nginx to Proxy Pass to Gunicorn"></a>Configure Nginx to Proxy Pass to Gunicorn</h2><h3 id="creating-and-opening-a-new-server-block-in-Nginx’s-sites-available-directory"><a href="#creating-and-opening-a-new-server-block-in-Nginx’s-sites-available-directory" class="headerlink" title="creating and opening a new server block in Nginx’s sites-available directory:"></a>creating and opening a new server block in Nginx’s <code>sites-available</code> directory:</h3><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/nginx/sites-available/myproject</span><br></pre></td></tr></tbody></table></figure><h3 id="The-comple-nginx-conf-file"><a href="#The-comple-nginx-conf-file" class="headerlink" title="The comple nginx conf file"></a>The comple nginx conf file</h3><figure class="highlight nginx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> {</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> server_domain_or_IP;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> = /favicon.ico { <span class="attribute">access_log</span> <span class="literal">off</span>; <span class="attribute">log_not_found</span> <span class="literal">off</span>; }</span><br><span class="line">    <span class="attribute">location</span> /static/ {</span><br><span class="line">        <span class="attribute">root</span> /home/sammy/myproject;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / {</span><br><span class="line">        <span class="attribute">include</span> proxy_params;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://unix:/home/sammy/myproject/myproject.sock;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Now-we-can-enable-the-file-by-linking-it-to-the-sites-enabled-directory"><a href="#Now-we-can-enable-the-file-by-linking-it-to-the-sites-enabled-directory" class="headerlink" title="Now, we can enable the file by linking it to the sites-enabled directory:"></a>Now, we can enable the file by linking it to the sites-enabled directory:</h3><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /etc/nginx/sites-available/myproject /etc/nginx/sites-enabled</span><br></pre></td></tr></tbody></table></figure><ul><li>Test <code>nginx</code></li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></tbody></table></figure><ul><li>Restart</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></tbody></table></figure><ul><li>Finally, we need to open up our firewall to normal traffic on port 80. Since we no longer need access to the development server, we can remove the rule to open port 8000 as well:</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw delete allow 8000</span><br><span class="line">sudo ufw allow <span class="string">'Nginx Full'</span></span><br></pre></td></tr></tbody></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Install-Packages-from-the-Ubuntu-Repositories-for-Python-3&quot;&gt;&lt;a href=&quot;#Install-Packages-from-the-Ubuntu-Repositories-for-Python-3&quot; class=&quot;headerlink&quot; title=&quot;Install Packages from the Ubuntu Repositories for Python 3&quot;&gt;&lt;/a&gt;Install Packages from the Ubuntu Repositories for Python 3&lt;/h2&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install python3-pip python3-dev libpq-dev postgresql postgresql-contrib nginx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="DevOps" scheme="http://zhou-en.github.io/categories/DevOps/"/>
    
    
      <category term="Django" scheme="http://zhou-en.github.io/tags/Django/"/>
    
      <category term="Deploy" scheme="http://zhou-en.github.io/tags/Deploy/"/>
    
      <category term="Nginx" scheme="http://zhou-en.github.io/tags/Nginx/"/>
    
      <category term="Gunicorn" scheme="http://zhou-en.github.io/tags/Gunicorn/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://zhou-en.github.io/2019/12/12/hello-world/"/>
    <id>http://zhou-en.github.io/2019/12/12/hello-world/</id>
    <published>2019-12-11T22:00:00.000Z</published>
    <updated>2021-01-26T21:21:55.563Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><a id="more"></a><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Quick Start" scheme="http://zhou-en.github.io/categories/Quick-Start/"/>
    
    
      <category term="Hexo" scheme="http://zhou-en.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>Python Datetime Libs</title>
    <link href="http://zhou-en.github.io/2019/10/02/Python-Datetime-Libs/"/>
    <id>http://zhou-en.github.io/2019/10/02/Python-Datetime-Libs/</id>
    <published>2019-10-02T00:39:57.000Z</published>
    <updated>2021-01-26T21:21:55.562Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Python-Date-Time-Libries-pytz-dateutil-and-pendulum"><a href="#Python-Date-Time-Libries-pytz-dateutil-and-pendulum" class="headerlink" title="Python Date Time Libries: pytz, dateutil, and pendulum"></a>Python Date Time Libries: <code>pytz</code>, <code>dateutil</code>, and <code>pendulum</code></h3><p>Write a few paragraphs on converting UTC datetime to localized timezone datetime using the 3 libraries.</p><a id="more"></a><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta</span><br><span class="line"><span class="keyword">import</span> pytz</span><br><span class="line"><span class="keyword">import</span> dateutil</span><br><span class="line"><span class="keyword">import</span> pendulum</span><br><span class="line"></span><br><span class="line"><span class="comment"># Test scenarios</span></span><br><span class="line"><span class="comment"># 1. Create a timezone free UTC version of now</span></span><br><span class="line"><span class="comment"># 2. Convert that to the following zones:</span></span><br><span class="line"><span class="comment"># - South Africa</span></span><br><span class="line"><span class="comment"># - US Eastern</span></span><br><span class="line"><span class="comment"># - US Pacific</span></span><br><span class="line"><span class="comment"># - Germany</span></span><br><span class="line"><span class="comment"># - Japan</span></span><br><span class="line"><span class="comment"># - India (Weird 30m offset)</span></span><br><span class="line"><span class="comment"># 3. Do the same for a specific time (2019/08/02 10:33:45+00:00)</span></span><br><span class="line"><span class="comment"># 3. Create a zoned UTC time on the edge of several DST switch overs</span></span><br><span class="line"><span class="comment"># 4. Check before and after times</span></span><br><span class="line"><span class="comment"># 6. Check what happens in the DST switch period (Sunday, November 3, 2:00 am LOCAL)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Some details on DST in the US: https://www.timeanddate.com/time/change/usa</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># fmt = '%Y-%m-%d %H:%M:%S.%f %Z%z'</span></span><br><span class="line">fmt = <span class="string">'%Y-%m-%d %H:%M:%S.%f %Z%z'</span></span><br><span class="line">utc_zone = <span class="string">'UTC'</span></span><br><span class="line">cat_zone = <span class="string">'Africa/Johannesburg'</span></span><br><span class="line">use_zone = <span class="string">'US/Eastern'</span></span><br><span class="line">ger_zone = <span class="string">'Europe/Berlin'</span></span><br><span class="line">tok_zone = <span class="string">'Asia/Tokyo'</span></span><br><span class="line">kol_zone = <span class="string">'Asia/Kolkata'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pytz_spike</span>():</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">'pytz'</span>)</span><br><span class="line">    print(<span class="string">'========'</span>)</span><br><span class="line">    <span class="comment"># Localize timezone free UTC now</span></span><br><span class="line">    now = datetime.datetime.utcnow()</span><br><span class="line"></span><br><span class="line">    utc = pytz.utc</span><br><span class="line">    cat = pytz.timezone(cat_zone)</span><br><span class="line">    use = pytz.timezone(use_zone)</span><br><span class="line">    ger = pytz.timezone(ger_zone)</span><br><span class="line">    tok = pytz.timezone(tok_zone)</span><br><span class="line">    kol = pytz.timezone(kol_zone)</span><br><span class="line"></span><br><span class="line">    utc_now = utc.localize(now)</span><br><span class="line">    cat_now = cat.localize(now)</span><br><span class="line">    use_now = use.localize(now)</span><br><span class="line">    ger_now = ger.localize(now)</span><br><span class="line">    tok_now = tok.localize(now)</span><br><span class="line">    kol_now = kol.localize(now)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">f'Localize timezone free now() to following timezone:'</span>)</span><br><span class="line">    print(utc_now.strftime(fmt))</span><br><span class="line">    print(cat_now.strftime(fmt))</span><br><span class="line">    print(use_now.strftime(fmt))</span><br><span class="line">    print(ger_now.strftime(fmt))</span><br><span class="line">    print(tok_now.strftime(fmt))</span><br><span class="line">    print(kol_now.strftime(fmt))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Localize a specific datetime, (2019/08/02 10:33:45+00:00)</span></span><br><span class="line">    target_date = datetime.datetime(<span class="number">2019</span>, <span class="number">7</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">33</span>, <span class="number">45</span>)</span><br><span class="line">    print(<span class="string">f'\nLocalize (2019/08/02 10:33:45+00:00) into following timezones:'</span>)</span><br><span class="line">    print(utc.localize(target_date).strftime(fmt))</span><br><span class="line">    print(cat.localize(target_date).strftime(fmt))</span><br><span class="line">    print(use.localize(target_date).strftime(fmt))</span><br><span class="line">    print(ger.localize(target_date).strftime(fmt))</span><br><span class="line">    print(tok.localize(target_date).strftime(fmt))</span><br><span class="line">    print(kol.localize(target_date).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Before DST</span></span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{use_zone}</span>: 10 January 2019, 12:34:12'</span>)</span><br><span class="line">    use_before = datetime.datetime(<span class="number">2019</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">999999</span>)</span><br><span class="line">    print(use.localize(use_before).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    before_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">30</span>, <span class="number">59</span>, <span class="number">999999</span>)</span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{use_zone}</span>: 2019-03-10, 02:00:00 clocks were turned forward 1 hour '</span>)</span><br><span class="line">    print(<span class="string">'timezone only changes after 3:00'</span>)</span><br><span class="line">    print(use.localize(before_dst).strftime(fmt))</span><br><span class="line">    minutes_added = <span class="number">40</span></span><br><span class="line">    print(<span class="string">f'Add <span class="subst">{minutes_added}</span> minutes:'</span>)</span><br><span class="line">    print(use.localize(before_dst+timedelta(minutes=minutes_added)).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    before_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">59</span>, <span class="number">999999</span>)</span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{use_zone}</span>: 2019-11-3, 02:00:00 clocks are turned backward 1 hour '</span>)</span><br><span class="line">    print(<span class="string">'timezone only changes after 3:00'</span>)</span><br><span class="line">    print(use.localize(before_dst).strftime(fmt))</span><br><span class="line">    minutes_added = <span class="number">100</span></span><br><span class="line">    print(<span class="string">f'Add <span class="subst">{minutes_added}</span> minutes:'</span>)</span><br><span class="line">    print(use.localize(before_dst + timedelta(minutes=minutes_added)).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'\n'</span>+use.localize(before_dst).strftime(fmt))</span><br><span class="line">    minutes_added = <span class="number">40</span></span><br><span class="line">    print(<span class="string">f'Add <span class="subst">{minutes_added}</span> minutes:'</span>)</span><br><span class="line">    print(use.localize(before_dst + timedelta(minutes=minutes_added)).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    after_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">30</span>, <span class="number">59</span>, <span class="number">999999</span>)</span><br><span class="line">    print(<span class="string">f'After DST: <span class="subst">{use.localize(after_dst).strftime(fmt)}</span>'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">python_dateutil_spike</span>():</span></span><br><span class="line">    print(<span class="string">'\ndateutil'</span>)</span><br><span class="line">    print(<span class="string">'========'</span>)</span><br><span class="line">    utc = dateutil.tz.gettz(utc_zone)</span><br><span class="line">    use = dateutil.tz.gettz(use_zone)</span><br><span class="line">    ger = dateutil.tz.gettz(ger_zone)</span><br><span class="line">    tok = dateutil.tz.gettz(tok_zone)</span><br><span class="line">    kol = dateutil.tz.gettz(kol_zone)</span><br><span class="line"></span><br><span class="line">    mar_10th = datetime.datetime(<span class="number">2019</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">30</span>, <span class="number">0</span>, <span class="number">0</span>, tzinfo=utc)</span><br><span class="line">    print(mar_10th.astimezone(utc).strftime(fmt))</span><br><span class="line">    print(mar_10th.astimezone(use).strftime(fmt) + <span class="string">f' <span class="subst">{use_zone}</span>'</span>)</span><br><span class="line">    minutes_added = <span class="number">40</span></span><br><span class="line">    print(<span class="string">f'Add <span class="subst">{minutes_added}</span> minutes'</span>)</span><br><span class="line">    mar_10th_updated = mar_10th + timedelta(minutes=minutes_added)</span><br><span class="line">    print(mar_10th_updated.astimezone(use).strftime(fmt) + <span class="string">f' <span class="subst">{use_zone}</span>'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pendulum_spike</span>():</span></span><br><span class="line">    print(<span class="string">'\npendulum'</span>)</span><br><span class="line">    print(<span class="string">'========'</span>)</span><br><span class="line">    <span class="comment"># Localize timezone free UTC now</span></span><br><span class="line">    utc_now = pendulum.utcnow()</span><br><span class="line">    year = utc_now.year</span><br><span class="line">    month = utc_now.month</span><br><span class="line">    day = utc_now.day</span><br><span class="line">    hour = utc_now.hour</span><br><span class="line">    minute = utc_now.minute</span><br><span class="line">    second = utc_now.second</span><br><span class="line">    micro_sec = utc_now.microsecond</span><br><span class="line"></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Create datetime string, timezone free</span></span><br><span class="line"><span class="string">    Localize the time string by adding timezones </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    print(<span class="string">'Localize UTC time now'</span>)</span><br><span class="line">    utc = pendulum.datetime(year, month, day, hour, minute, second, micro_sec, tzinfo=utc_zone)</span><br><span class="line">    print(<span class="string">f'<span class="subst">{utc.strftime(fmt)}</span>  -\t<span class="subst">{utc_zone}</span>'</span>)</span><br><span class="line"></span><br><span class="line">    cat = pendulum.datetime(year, month, day, hour, minute, second, micro_sec, tzinfo=cat_zone)</span><br><span class="line">    print(<span class="string">f'<span class="subst">{cat.strftime(fmt)}</span> -\t<span class="subst">{cat_zone}</span>'</span>)</span><br><span class="line"></span><br><span class="line">    use = pendulum.datetime(year, month, day, hour, minute, second, micro_sec, tzinfo=use_zone)</span><br><span class="line">    print(<span class="string">f'<span class="subst">{use.strftime(fmt)}</span>  -\t<span class="subst">{use_zone}</span>'</span>)</span><br><span class="line"></span><br><span class="line">    ger = pendulum.datetime(year, month, day, hour, minute, second, micro_sec, tzinfo=ger_zone)</span><br><span class="line">    print(<span class="string">f'<span class="subst">{ger.strftime(fmt)}</span> -\t<span class="subst">{ger_zone}</span>'</span>)</span><br><span class="line"></span><br><span class="line">    tok = pendulum.datetime(year, month, day, hour, minute, second, micro_sec, tzinfo=tok_zone)</span><br><span class="line">    print(<span class="string">f'<span class="subst">{tok.strftime(fmt)}</span>  -\t<span class="subst">{tok_zone}</span>'</span>)</span><br><span class="line"></span><br><span class="line">    kol = pendulum.datetime(year, month, day, hour, minute, second, micro_sec, tzinfo=kol_zone)</span><br><span class="line">    print(<span class="string">f'<span class="subst">{kol.strftime(fmt)}</span>  -\t<span class="subst">{kol_zone}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line">    before_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">3</span>, <span class="number">31</span>, <span class="number">1</span>, <span class="number">59</span>, <span class="number">59</span>, <span class="number">999999</span>)</span><br><span class="line">    ger = pendulum.datetime(</span><br><span class="line">        before_dst.year, before_dst.month, before_dst.day, before_dst.hour,</span><br><span class="line">        before_dst.minute, before_dst.second, before_dst.microsecond,</span><br><span class="line">        tzinfo=ger_zone</span><br><span class="line">    )</span><br><span class="line">    print(</span><br><span class="line">        <span class="string">f'\n<span class="subst">{ger_zone}</span>: '</span></span><br><span class="line">        <span class="string">f'Sunday, 31 March 2019, 02:00:00 clocks were turned forward 1 hour'</span></span><br><span class="line">    )</span><br><span class="line">    print(ger.strftime(fmt))</span><br><span class="line">    print(<span class="string">'Add 1 microsecond'</span>)</span><br><span class="line">    print(ger.add(microseconds=<span class="number">1</span>).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    before_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">10</span>, <span class="number">27</span>, <span class="number">1</span>, <span class="number">59</span>, <span class="number">59</span>, <span class="number">999999</span>)</span><br><span class="line">    ger = pendulum.datetime(</span><br><span class="line">        before_dst.year, before_dst.month, before_dst.day, before_dst.hour,</span><br><span class="line">        before_dst.minute, before_dst.second, before_dst.microsecond,</span><br><span class="line">        tzinfo=ger_zone</span><br><span class="line">    )</span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{ger_zone}</span>: Sunday, 27 October 2019, 03:00:00 clocks are turned backward 1 hour'</span>)</span><br><span class="line">    print(ger.strftime(fmt))</span><br><span class="line">    print(<span class="string">f'Add 85 minutes to pass 3:00'</span>)</span><br><span class="line">    print(ger.add(minutes=<span class="number">85</span>).strftime(fmt))</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line">    before_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">999999</span>)</span><br><span class="line">    use = pendulum.datetime(</span><br><span class="line">        before_dst.year, before_dst.month, before_dst.day, before_dst.hour,</span><br><span class="line">        before_dst.minute, before_dst.second, before_dst.microsecond,</span><br><span class="line">        tzinfo=use_zone</span><br><span class="line">    )</span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{use_zone}</span>: 10 January 2019, 12:34:12'</span>)</span><br><span class="line">    print(use.strftime(fmt))</span><br><span class="line"></span><br><span class="line">    before_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">30</span>, <span class="number">59</span>, <span class="number">999999</span>)</span><br><span class="line">    use = pendulum.datetime(</span><br><span class="line">        before_dst.year, before_dst.month, before_dst.day, before_dst.hour,</span><br><span class="line">        before_dst.minute, before_dst.second, before_dst.microsecond,</span><br><span class="line">        tzinfo=use_zone</span><br><span class="line">    )</span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{use_zone}</span>: Sunday, 10 March 2019, 02:00:00 clocks were turned forward 1 hour'</span>)</span><br><span class="line">    print(<span class="string">'Timezone starts changing after 2:00'</span>)</span><br><span class="line">    print(use.strftime(fmt))</span><br><span class="line">    minutes_added = <span class="number">40</span></span><br><span class="line">    print(<span class="string">f'Add <span class="subst">{minutes_added}</span> minutes:'</span>)</span><br><span class="line">    print(use.add(minutes=minutes_added).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    after_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">999999</span>)</span><br><span class="line">    use = pendulum.datetime(</span><br><span class="line">        after_dst.year, after_dst.month, after_dst.day, after_dst.hour,</span><br><span class="line">        after_dst.minute, after_dst.second, after_dst.microsecond,</span><br><span class="line">        tzinfo=use_zone</span><br><span class="line">    )</span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{use_zone}</span>: 5 April 2019, 12:34:12'</span>)</span><br><span class="line">    print(use.strftime(fmt))</span><br><span class="line"></span><br><span class="line">    before_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">00</span>, <span class="number">0</span>)</span><br><span class="line">    use = pendulum.datetime(</span><br><span class="line">        before_dst.year, before_dst.month, before_dst.day, before_dst.hour,</span><br><span class="line">        before_dst.minute, before_dst.second, before_dst.microsecond,</span><br><span class="line">        tzinfo=use_zone</span><br><span class="line">    )</span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{use_zone}</span>: Sunday, 3 November 2019, 02:00:00 clocks are turned backward 1 hour '</span>)</span><br><span class="line">    print(use.strftime(fmt))</span><br><span class="line">    minutes_added = <span class="number">85</span></span><br><span class="line">    print(<span class="string">f'Add: <span class="subst">{minutes_added}</span> minutes'</span>)</span><br><span class="line">    print(use.add(minutes=minutes_added).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    before_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">00</span>, <span class="number">0</span>)</span><br><span class="line">    use = pendulum.datetime(</span><br><span class="line">        before_dst.year, before_dst.month, before_dst.day, before_dst.hour,</span><br><span class="line">        before_dst.minute, before_dst.second, before_dst.microsecond,</span><br><span class="line">        tzinfo=use_zone</span><br><span class="line">    )</span><br><span class="line">    print(<span class="string">'\n'</span> + use.strftime(fmt))</span><br><span class="line">    minutes_added = <span class="number">35</span></span><br><span class="line">    print(<span class="string">f'Add: <span class="subst">{minutes_added}</span> minutes'</span>)</span><br><span class="line">    print(use.add(minutes=minutes_added).strftime(fmt))</span><br><span class="line"></span><br><span class="line">    after_dst = datetime.datetime(<span class="number">2019</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">999999</span>)</span><br><span class="line">    use = pendulum.datetime(</span><br><span class="line">        after_dst.year, after_dst.month, after_dst.day, after_dst.hour,</span><br><span class="line">        after_dst.minute, after_dst.second, after_dst.microsecond,</span><br><span class="line">        tzinfo=use_zone</span><br><span class="line">    )</span><br><span class="line">    print(<span class="string">f'\n<span class="subst">{use_zone}</span>: <span class="subst">{use.strftime(fmt)}</span>'</span>)</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    pytz_spike()</span><br><span class="line">    python_dateutil_spike()</span><br><span class="line">    pendulum_spike()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>]]></content>
    
    <summary type="html">
    
      This was a tech spike I did for investigating the 3 datetime libraries we were interested in a project.
    
    </summary>
    
    
    
      <category term="Python" scheme="http://zhou-en.github.io/tags/Python/"/>
    
      <category term="Datetime" scheme="http://zhou-en.github.io/tags/Datetime/"/>
    
  </entry>
  
  <entry>
    <title>Enable Sublime Text in Tmux Command Line on MacOS</title>
    <link href="http://zhou-en.github.io/2018/07/12/2018-07-12-Enable-Sublime-Text-in-Tmux-Command-Line-on-MacOS/"/>
    <id>http://zhou-en.github.io/2018/07/12/2018-07-12-Enable-Sublime-Text-in-Tmux-Command-Line-on-MacOS/</id>
    <published>2018-07-11T22:00:00.000Z</published>
    <updated>2021-01-26T21:21:55.560Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Problem-Description"><a href="#Problem-Description" class="headerlink" title="Problem Description"></a>Problem Description</h2><p>When you create a symbolic link to start sublime text editor from command line in tmux, you get an error message:</p><figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Unable to launch sublime text</span><br></pre></td></tr></tbody></table></figure><p>This is due to tmux doesn’t have root access to the bin directory. The following steps fixed this issue for me on my Mac.</p><a id="more"></a><h2 id="System-Details-and-Application"><a href="#System-Details-and-Application" class="headerlink" title="System Details and Application"></a>System Details and Application</h2><ul><li><p>OS:</p>  <figure class="highlight text"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">macOS Version 10.13.5</span><br></pre></td></tr></tbody></table></figure></li><li><p>Applications:</p>  <figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sublime Text 3</span><br><span class="line">Tmux running from iTerm 2</span><br></pre></td></tr></tbody></table></figure></li></ul><h2 id="Create-Symbolic-Link-for-Sublime-Text-3"><a href="#Create-Symbolic-Link-for-Sublime-Text-3" class="headerlink" title="Create Symbolic Link for Sublime Text 3"></a>Create Symbolic Link for Sublime Text 3</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /Applications/Sublime\ Text.app/Contents/SharedSupport/bin/subl /usr/<span class="built_in">local</span>/bin/subl</span><br></pre></td></tr></tbody></table></figure><h2 id="Install-a-wrapper-to-handle-subl-w-in-tmux"><a href="#Install-a-wrapper-to-handle-subl-w-in-tmux" class="headerlink" title="Install a wrapper to handle subl -w in tmux"></a>Install a wrapper to handle subl -w in tmux</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install reattach-to-user-namespace</span><br></pre></td></tr></tbody></table></figure><h2 id="Add-command-to-tmux-conf"><a href="#Add-command-to-tmux-conf" class="headerlink" title="Add command to ~/.tmux.conf"></a>Add command to <code>~/.tmux.conf</code></h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"set-option -g default-command \"reattach-to-user-namespace -l bash\""</span> &gt;&gt; ~/.tmux.conf</span><br></pre></td></tr></tbody></table></figure><h2 id="Restart-the-tmux-server"><a href="#Restart-the-tmux-server" class="headerlink" title="Restart the tmux server"></a>Restart the tmux server</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux kill-server</span><br></pre></td></tr></tbody></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Problem-Description&quot;&gt;&lt;a href=&quot;#Problem-Description&quot; class=&quot;headerlink&quot; title=&quot;Problem Description&quot;&gt;&lt;/a&gt;Problem Description&lt;/h2&gt;&lt;p&gt;When you create a symbolic link to start sublime text editor from command line in tmux, you get an error message:&lt;/p&gt;
&lt;figure class=&quot;highlight text&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Unable to launch sublime text&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;This is due to tmux doesn’t have root access to the bin directory. The following steps fixed this issue for me on my Mac.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Text Editor" scheme="http://zhou-en.github.io/categories/Text-Editor/"/>
    
      <category term="IDE" scheme="http://zhou-en.github.io/categories/Text-Editor/IDE/"/>
    
    
      <category term="Sublime" scheme="http://zhou-en.github.io/tags/Sublime/"/>
    
  </entry>
  
  <entry>
    <title>En Zhou Launches Site</title>
    <link href="http://zhou-en.github.io/2017/08/25/2017-08-25-ZhouEn-site-launched/"/>
    <id>http://zhou-en.github.io/2017/08/25/2017-08-25-ZhouEn-site-launched/</id>
    <published>2017-08-24T22:00:00.000Z</published>
    <updated>2021-01-26T21:21:55.559Z</updated>
    
    <content type="html"><![CDATA[<p>Well. Finally got around to putting this old website together. Neat thing about it - powered by <a href="http://jekyllrb.com">Jekyll</a> and I can use Markdown to author my posts. It actually is a lot easier than I thought it was going to be.</p><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Well. Finally got around to putting this old website together. Neat thing about it - powered by &lt;a href=&quot;http://jekyllrb.com&quot;&gt;Jekyll&lt;/a&gt; and I can use Markdown to author my posts. It actually is a lot easier than I thought it was going to be.&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
</feed>
